{% extends 'main.html' %}

{% block content %}
{% load static %}

<!-- Shopping Cart Page -->
<section class="py-16 px-4 bg-white min-h-screen">
  <div class="max-w-6xl mx-auto">

    <!-- Page Title -->
    <h1 class="text-3xl md:text-4xl font-bold mb-12 text-gray-800 text-center">Shopping Cart</h1>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">

      <!-- Cart Items (Left Side - 2/3 width) -->
      <div class="lg:col-span-2 space-y-6">
        {% for item in cart_items %}
        
        <div class="flex items-center gap-4 bg-white border border-gray-200 rounded-lg p-4 cart-item" data-product-id="{{ item.product.id }}">


          
          <!-- Product Image -->
          {% if item.product.product_image %}
            <img src="{{ item.product.product_image.url }}" alt="{{ item.product.name }}" class="w-20 h-20 object-cover rounded">
          {% else %}
            <img src="{% static 'images/placeholder.png' %}" alt="{{ item.product.name }}" class="w-20 h-20 object-cover rounded">
          {% endif %}

          <!-- Product Info -->
          <div class="flex-1">
            <h3 class="text-xl font-bold text-gray-800">{{ item.product.name }}</h3>
            <p class="text-lg text-[#8B5E3C] font-semibold">₦{{ item.product.price }}</p>
          </div>
        
           <!-- Quantity Controls -->
           <div class="flex gap-2">
            <button class="quantity-btn w-8 h-8 flex items-center justify-center border border-gray-300 rounded hover:bg-gray-100" data-action="remove" data-product-id="{{ item.product.id }}">
              −
            </button>
            <span class="text-lg font-semibold w-8 text-center" id="qty-{{ item.product.id }}">{{ item.quantity }}</span>
            <button class="quantity-btn w-8 h-8 flex items-center justify-center border border-gray-300 rounded hover:bg-gray-100" data-action="add" data-product-id="{{ item.product.id }}">
              +
            </button>
          </div>
         

          <!-- Item Total -->
          <div class="item-total text-lg font-semibold text-gray-800" id="total-{{ item.product.id }}">
            ₦{{ item.get_total|floatformat:2 }}
          </div>

          <!-- Remove Button -->
          <button class="text-red-600 hover:text-red-800 transition remove-item" data-action="delete" data-product-id="{{ item.product.id }}">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                    d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
            </svg>
          </button>

        </div>

        {% empty %}
        <p class="text-gray-600 text-center">Your cart is empty.</p>
        {% endfor %}
      </div>

      <!-- Order Summary (Right Side - 1/3 width) -->
      <div class="lg:col-span-1">
        <div class="bg-gray-50 rounded-lg p-6 sticky top-4">

          <h2 class="text-2xl font-bold mb-6 text-gray-800">Order Summary</h2>

          <!-- Items -->
          <div class="flex justify-between mb-3">
            <span class="text-gray-600">Items <span id="cart-items">{{ cart_items_count }}</span></span>
            <span class="text-gray-800 font-semibold" id="cart-total">₦{{ cart_total }}</span>
          </div>

          <!-- Shipping -->
          <div class="flex justify-between mb-6">
            <span class="text-gray-600">Shipping</span>
            <span class="text-gray-800 font-semibold">Free</span>
          </div>

          <!-- Divider -->
          <div class="border-t border-gray-300 my-4"></div>

          <!-- Total -->
          <div class="flex justify-between mb-6">
            <span class="text-xl font-bold text-gray-800">Total</span>
            <span class="text-xl font-bold text-gray-800" id="cart-total-final">₦{{ cart_total }}</span>
          </div>

          <!-- Proceed to Checkout -->
          <a href="{% url 'checkout' %}" class="block text-center text-gray-600 bg-[#8B5E3C] hover:bg-[#6B4423] text-white font-semibold py-3 rounded mb-3 transition duration-300">
            Proceed to Checkout
          </a>

          <!-- Continue Shopping -->
          <a href="{% url 'product_page' %}" class="block text-center text-gray-600 hover:text-[#8B5E3C] font-semibold transition duration-300">
            Continue Shopping
          </a>

        </div>
      </div>

    </div>
  </div>
</section>

{% endblock %}
